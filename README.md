# HTTP Калькулятор
## Данный калькулятор работает с дробными числами (например _4.32_), но не работает с унарным минусом (например _5 +-7_ или _5 +(-7)_)  

Перед работой убедитесь, что у вас установлен [golang](https://go.dev/dl/) и [curl](https://curl.se/download.html)  
Также для POST запросов можно использовать [Postman](https://www.postman.com/downloads/)  
После этого:
 1. Перейдите в папку, куда вы хотите склонировать репозиторий, например `C:/Code/LMS`
 2. Скопируйте репозиторий командой `git clone https://github.com/Jacobeaen/Calculator.git`
После данных операций, у вас будет вот такая структура каталогов:
```
LMS
└───Calculator/
    ├───pkg/
    │    └───rpn/
    │        ├── calc.go/          
    │        ├── validate.go       
    │        └── rpn_test.go
    ├───internal/
    │        └───application/
    │            └───handlers.go
    ├───cmd/
    │    └───main.go
    ├───go.mod
    └───README.md
```
Перейдите в папку _сmd_: `cd Calculator/cmd` и запустите _main.go_: `go run main.go`  
Либо сразу запустите _main.go_: `go run Calclator/cmd/main.go`  
Вам надо будет послать POST запрос на 8080 порт сервера:
1. Пример с помощью _curl_:

   - `curl -X POST --location '127.0.01:8080/api/v1/calculate' -H 'Content-Type: application/json' -d '{"expression": "2+2"}'`
2. Пример с помощью _postman_:

    - Откройте postman и создайте POST запрос
    - В **URL** введите _127.0.01:8080/api/v1/calculate_
    - В **Body** выберите _raw_ и установите формат _json_
    - В **Json** вставьте `{"expression": "2+2"}`
Флаг _-X_ и значени _POST_ в _curl_ необязательны. Они всего лишь указывают на метод запроса (при отправке json запрос автоматически POST)  
В зависимости от запроса сервер может вернуть 4 HTTP ответа с телами:
1. `"result": "результат выражения"` и код 200, если выражение вычислено успешно
2. `"error": "Expression is not valid"` и код 422, если в выражении не правильно
3. `"error: "Bad request"` и код 400, если вы неправильно сформировали json (нет ключа или значения)
4. `"error": "Internal server error"` и код 500, если возникла ошибка, не учитываемая в пункте 2

PS. У меня не получилось сгенерировать код 500, тк я попробовал учесть все случаи для ошибок в выражении, однако, если у вас получилось сгенерировать код 500, напишите мне на почту - ***susanin935@gmail.com***  
Также обязательно смотрите, чтобы в ключе json было именно **expression**, иначе вы получите код 422  
Также в ходе тестов было определено, что некоторые выражения считаются неправильно - калькулятор писался с нуля и требует доработки. Если вы хотите сообщить о таких случаях, просьба отправлять такие выражения на почту.

Примеры запросов для сервера и ожидаемые ответы:
| ✅Правильные запросы | Ответы сервера - (200 OK)|
|--------------------  |-------|
|curl --location '127.0.0.1:8080/api/v1/calculate' --header 'Content-Type: application/json' --data '{"expression":"1+1"}' |{"result":"2"}|
|curl --location '127.0.0.1:8080/api/v1/calculate' --header 'Content-Type: application/json' --data '{"expression":"(1+1 * 9)"}'|{"result":"18"}|
|curl --location '127.0.0.1:8080/api/v1/calculate' --header 'Content-Type: application/json' --data '{"expression":"5*7-3/2"}'|{"result":"33.5"}|

| ❌Неправильные запросы | Ответы сервера|
|--------------------  |-------|
| curl --location '127.0.0.1:8080/api/v1/calculate' -H 'Content-Type: application/json' --data '{"expression":""}|{"error":"Expression is not valid.. empty expression"}|
| Неправильный запрос №2 |Ответ №2|
| ЕНеправильный запрос №3 |Ответ №3|

Если не получилось отправить POST запрос, возможно, ошибка в cmd или PowerShell  
В таком случае рекомендую воспользоваться _gitBash_, который поставляется вместе с _git_ (в _cmd_ или _PS_  пропишите `git bash`) или терминалом (для этого надо установить _wsl_ и выбрать установленный дистрибутив Linux)